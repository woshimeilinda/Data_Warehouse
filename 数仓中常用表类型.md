# 数仓中常用表，及其作用

## 全量表、快照表、增量表、拉链表、维度表、实体表、事实表是数据仓库中常见的表格类型。

1. **全量表**是数据仓库中数据最全面、完整的表，包含所有**历史数据和当前数据**。全量表的数据量通常很大，因此查询全量表可能需要较长时间。

2. **快照表**是特定时间点的全量表，它只包含特定**时间点的数据，而没有历史数据**。快照表通常用于查询特定时间点的数据，因为它的数据量比全量表小，查询速度更快。

3. **增量表**是只包含增量数据的表，它不包含历史数据。**增量表通常用于更新全量表或快照表**，以避免重复加载数据。

4. **拉链表**是一种特殊的增量表，它包含**历史数据和当前数据之间的差异**。拉链表通常用于时间序列数据的存储和处理。

5. **维度表**是数据仓库中的一种特殊类型的表，它包含用于查询和分析数据的**维度信息，例如时间、地区、产品、订单状态，支付方式，审批状态，商品分类等**。维度表通常包含过滤条件和分组条件，以支持多种查询和分析场景。

6. **实体表**是一种特殊的维度表，它包含**特定实体的所有历史数据和当前数据**。实体表通常用于存储和管理特定实体的数据，例如客户、产品等。

7. **事实表**是数据仓库中的另一种特殊类型的表，它包含用于**计算和分析事实的数据**。事实表通常包含**度量值和关联维度**，可以用于计算多种指标和度量，例如销售额、成本等。

在数据仓库中，不同的表格类型具有不同的用途和特点，它们可以组合使用，以支持多种查询和分析场景。了解这些表格类型的特点和用途是构建有效数据仓库的重要前提。

## 补充：
**实体表** ：指现实存在的对象，比如用户，商品，商家，销售员；如果你是老板，你会如何登记一条顾客的数据，这个顾客的信息数据就是实体表里面的一条数据

*维度表*：

**事实表** ：事实表
事实表中的每行数据代表一个业务事件（比如说你在淘宝上下单、支付、退款、评价等各种行为都算作一个事件）。那么“事实”这个术语表示的是业务事件的度量值（我们可以统计次数、个数、金额等），例如，今年的双十一，你在哪家店铺买了多少钱买了多少商品，那么这个对应我们可以将这一个动作记录在维度表中的：时间，用户，商品，店铺，登记在事实表里面的度量值可以有购买金额和购买数量。

每一个事实表的行包括：具有可加性的数值型的度量值【因为最能体现出效果的就是数字啦】、与维度表相连接的外键【我的理解就是不然光秃秃你也不知道咋讲啥】、通常具有两个和两个以上的外键、外键之间表示维表之间多对多的关系。

那么事实表的特征：首先 数据量非常的大(行数)，因为就光双十一这一天产生多少订单，然后我们的一切行为数据就会被这么记录了，那么可以想象那行能不多嘛， 内容相对的窄：列数较少（主要是外键id和度量值），这个是因为事实表的设计初衷就是这样，想要窄窄的记录重要的信息，不负责属性的各种描述，并且它还会经常发生变化，每天会新增加很多，还是拿电商举例就是说，每天的订单记录会不停在增加。

在此基础上于是就产生了三大事实表！

1）事务型事实表

事务事实表的粒度是每一行数据对应一个事务，或者一行对应事务中的一个条目。事务可以理解为业务过程中的各个事件节点，比如网购交易过程中的创建订单，买家付款，物流过程中的揽活，发货，签收，退款过程中的申请退款，确认退款等，都可以理解为事务。事务事实表针对这些过程构建，作为数仓的原子明细数据，可以跟踪定义业务过程的事件，提供丰富的分析能力。

事务事实表只有事务发生才会新增对应的一条数据，一般不会做更新操作。

简单来说，事实表就是以每个事务或事件为单位，比如说一个销售订单记录，一笔支付记录等，我们都可以作为事实表里的一行数据。一旦事务被提交，事实表数据被插入，数据就不再进行更改，其更新方式为每日增量更新。

2）周期型快照事实表

周期快照事实表在了解有规律的、可预见时间间隔的业务累计性能方面很有必要。与针对每个出现的事件都要加载一行数据的事务事实表不同，利用周期快照可以在每天，每周，每月结束时，为当时的行为进行拍照，然后在下一周期拍另一张照片，比如商品库存，账户余额，每日交易额，每月累计交易额等。事务事实表需要聚集长期的事务历史才能得出这些结果，使用效率比较差，可以用周期快照作为事务事实表的补充。

周期型快照事实表中不会保留所有数据，只保留固定时间间隔的数据，例如每天或者每月的销售额，或每月的账户余额等。还有就是例如购物车，有加减商品，随时都有可能变化，但是我们更关心每天结束时这里面有多少商品，方便我们后期统计分析。因此周期型快照事实表的更新方式为每日全量更新，即每日对数据做一个快照。

3）累积型快照事实表

累积快照表完全涵盖一个事务或者离散产品（或者用户）的生命期的不确定跨度。累积快照表具有多个日期字段，用于对应可预见的主要事件或者环节的发生时间。通常还有一个用于指示快照行最后一次更新的附加日期列。

累积快照事实表需要对数据进行重新访问，当某一事件发生后，需要对应时间字段和相关度量进行更新操作，而不是新增一行。累积快照可以很好的满足某些特殊的需求，例如:统计下单到支付的时长，支付到发货的时长，下单到确认收货的时长等。如果用事务事实表的话逻辑复杂且性能较差。

**换句话说累积快照事实表用于跟踪业务事实的变化。**例如，数据仓库中可能需要累积或者存储订单从下订单开始，到订单商品被打包、运输、和签收的各个业务阶段的时间点数据来跟踪订单生命周期的进展情况。当这个业务过程进行时，事实表的记录也要不断更新。
